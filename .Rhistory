jilin_1987 <- jilin_1987_1[,-c(3,4,5)]
#黑龙江省1987年数据#
heilongjiang_1987_1 <- subset(
table_1987_2, table_1987_2[,3]==23
&(table_1987_2[,5]=="00"|table_1987_2[,4]=="90")
)
heilongjiang_1987 <- heilongjiang_1987_1[,-c(3,4,5)]
View(jilin_1987)
View(hebei_1987)
View(heilongjiang_1986)
View(heilongjiang_1987)
library(rvest)
library(tidyverse)
library(stringr)
web <- vector("list", 3)
for (i in 1:3)
{
web_m <- 'http://www.mca.gov.cn/article/sj/xzqh/1980/?'
web[[i]] <- read_html(web_m)
i = i+1
paste(web_m, i)
}
web
View(web)
web <- vector("list", 3)
for (i in 1:3)
{
web_m <- 'http://www.mca.gov.cn/article/sj/xzqh/1980/?'
web[[i]] <- web_m
i = i+1
paste(web_m, i)
}
web
web <- vector("list", 3)
for (i in 1:3)
{
web_m <- 'http://www.mca.gov.cn/article/sj/xzqh/1980/?'
web[[i]] <- web_m
i = i+1
paste(web_m,i)
}
web
paste(a,s)
web <- vector("list", 3)
for (i in 1:3)
{
web_m <- 'http://www.mca.gov.cn/article/sj/xzqh/1980/?'
web[[i]] <- web_m
i = i+1
paste(web_m,"i")
}
web
web <- vector("list", 3)
for (i in 1:3)
{
web_m <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[i]] <- web_m
i = i+1
paste(web_m,"i")
}
web
web <- vector("list", 3)
web_m <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
for (i in 1:3)
{
web[[i]] <- web_m
i = i+1
paste(web_m,"i")
}
web
web <- vector("list", 3)
web_m <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
for (i in 1:3)
{
web[[i]] <- web_m
i = i+1
web_m <- paste(web_m,"i")
}
web
web <- vector("list", 3)
web_m <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
for (i in 1:3)
{
web[[i]] <- web_m
i = i+1
web_m <- paste(web_m,i)
}
web
web <- vector("list", 3)
web_m <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
for (i in 1:3)
{
web[[i]] <- web_m
i = i+1
web_m <- paste(web_m,i, collapse = "")
}
web
web <- vector("list", 3)
web_m <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
for (i in 1:3)
{
web[[i]] <- web_m
i = i+1
web_m <- paste(web_m,i, seq = "", collapse = "")
}
web
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- web_base
for (i in 2:3)
{
web[[i]] <- web_m
i = i+1
web_m <- paste(web_base,i, seq = "", collapse = "")
}
web
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- web_base
for (i in 2:3)
{
web[[i]] <- web_m
i = i+1
web_m <- paste0(web_base,i, seq = "", collapse = "")
}
web
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- web_base
for (i in 2:3)
{
web[[i]] <- web_m
i = i+1
web_m <- paste0(web_base,i)
}
web
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- web_base
for (i in 1:2)
{
web[[i]] <- web_m
i = i+1
web_m <- paste0(web_base,i)
}
web
for (i in 1:3)
{
web[[i]] <- web_m
i = i+1
web_m <- paste0(web_base,i)
}
web
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- web_base
for (i in 1:3)
{
web[[i+1]] <- web_m
i = i+1
web_m <- paste0(web_base,i)
}
web
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- web_base
for (i in 1:3)
{
web[[i+1]] <- web_m
i = i+1
web_m <- paste0(web_base,i)
if(i == 3)
{
break
}
}
web
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- web_base
for (i in 1:2)
{
web[[i+1]] <- web_m
i = i+1
web_m <- paste0(web_base,i)
}
web
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- web_base
for (i in 1:2)
{
web_m <- paste0(web_base,i)
web[[i+1]] <- web_m
i = i+1
}
web
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- web_base
for (i in 1:2)
{
web_m <- paste0(web_base,i+1)
web[[i+1]] <- web_m
i = i+1
}
web
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- web_base
for (i in 1:2)
{
web_m <- paste0(web_base,i+1)
web[[i+1]] <- read_html(web_m)
i = i+1
}
View(web)
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- read_html(web_base)
for (i in 1:2)
{
web_m <- paste0(web_base,i+1)
web[[i+1]] <- read_html(web_m)
i = i+1
}
#爬取每年的网站链接#
k <- html_nodes(web[[1]], div.alist a)
#爬取每年的网站链接#
k <- html_nodes(web[[1]], div.alist mt20, a)
#爬取每年的网站链接#
k <- html_nodes(web[[1]], "div.alist, a")
View(k)
View(web)
#爬取每年的网站链接#
k <- html_table(web[[1]])
xml_attrs(k[[98]])[["href"]]yes
#爬取每年的网站链接#
k <- html_table(web[[1]])
yes
help("html_table")
#爬取每年的网站链接#
k <- html_table(web[[1]], fill = ture)
#爬取每年的网站链接#
k <- html_table(web[[1]], fill = TRUE)
#爬取每年的网站链接#
k <- html_table(web[[1]], "table") %>% html_table()
#爬取每年的网站链接#
k <- html_table(web[[1]], "table") %>% html_table(fill = TRUE)
#爬取每年的网站链接#
k <- html_nodes(web[[1]], "div.alist a")
head(k)
View(k)
k <- html_nodes(web[[1]], "div.alist a") %>% html_attr("herf")
head(k)
#爬取每年的网站链接#
k <- html_nodes(web[[1]], "div.alist a") %>% html_attr("href")
head(k)
for(i in 1:3)
{
year_link <- html_nodes(web[[i]], "div.alist a") %>% html_attr("href")
i = i+1
}
head(year_link)
year_link <- vector(string, 42)
for(i in 1:3)
{
year_link <- html_nodes(web[[i]], "div.alist a") %>% html_attr("href")
i = i+1
}
head(year_link)
help("vector")
year_link <- vector("list", 42)
for(i in 1:3)
{
year_link <- html_nodes(web[[i]], "div.alist a") %>% html_attr("href")
i = i+1
}
head(year_link)
year_link <- vector("list", 42)
for(i in 1:3)
{
year_link[i] <- html_nodes(web[[i]], "div.alist a") %>% html_attr("href")
i = i+1
}
head(year_link)
help("vector")
year_link <- vector("list", 42)
for(i in 1:3)
{
year_link[[i]] <- html_nodes(web[[i]], "div.alist a") %>% html_attr("href")
i = i+1
}
head(year_link)
year_link <- vector("list", 3)
for(i in 1:3)
{
year_link[[i]] <- html_nodes(web[[i]], "div.alist a") %>% html_attr("href")
i = i+1
}
head(year_link)
library(rvest)
library(tidyverse)
library(stringr)
#爬取主页面#
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- read_html(web_base)
for(i in 1:2)
{
web_m <- paste0(web_base,i+1)
web[[i+1]] <- read_html(web_m)
i = i+1
}
#爬取每年的网站链接#
year_link <- vector("list", 3)
for(i in 1:3)
{
year_link[[i]] <- html_nodes(web[[i]], "div.alist a") %>% html_attr("href")
i = i+1
}
head(year_link)
k <- html_table(web[[1]][15])
k <- read_html(web[[1]][15]) %>% html_table()
View(year_link)
k <- read_html(year_link[[1]][15]) %>% html_table()
k <- read_html("http://www.mca.gov.cn/article/sj/xzqh/1980/201507/20150715854907.shtml") %>% html_table()
k <- read_html("http://www.mca.gov.cn/article/sj/xzqh/1980/201507/20150715854907.shtml") %>% html_table()
k <- read_html("http://www.mca.gov.cn/article/sj/xzqh/1980/201507/20150715854907.shtml")
View(k)
library(rvest)
library(tidyverse)
library(stringr)
#下载表格#
url_1987 <- "http://www.mca.gov.cn/article/sj/xzqh/1980/1980/201911180950.html"
web_1987 <- read_html(url_1987)
table_1987 <- html_table(web_1987)
#数据处理#
table_1987_1 <- table_1987[[1]][-c(1,2,3), -c(1,4,5,6,7,8,9)]
head(table_1987_1)
prov <- str_sub(table_1987_1[,1], 1, 2) #选取前两位省代号
prov_coun <- str_sub(table_1987_1[,1], 3, 4) #选取中间两位以区分省直辖县
city <- str_sub(table_1987_1[,1], 5, 6) #选取最后两位以区分地级市
table_1987_2 <- data.frame(table_1987_1, prov, prov_coun, city)
#河北省1987年数据#
hebei_1987_1 <-
subset(
table_1987_2,
table_1987_2[,3]==13 & (table_1987_2[,5]=="00" | table_1987_2[,4]=="90")
)
hebei_1987 <- hebei_1987_1[,-c(3,4,5)]
#辽宁省1987年数据#
liaoning_1987_1 <-
subset(
table_1987_2,
table_1987_2[,3]==21 & (table_1987_2[,5]=="00" | table_1987_2[,4]=="90")
)
liaoning_1987 <- liaoning_1987_1[,-c(3,4,5)]
#吉林省1987年数据#
jilin_1987_1 <-
subset(
table_1987_2,
table_1987_2[,3]==22 & (table_1987_2[,5]=="00" | table_1987_2[,4]=="90")
)
jilin_1987 <- jilin_1987_1[,-c(3,4,5)]
#黑龙江省1987年数据#
heilongjiang_1987_1 <-
subset(
table_1987_2,
table_1987_2[,3]==23 & (table_1987_2[,5]=="00" | table_1987_2[,4]=="90")
)
heilongjiang_1987 <- heilongjiang_1987_1[,-c(3,4,5)]
View(jilin_1987)
View(hebei_1987)
View(liaoning_1987)
library(tidyverse)
library(tidyverse)
library(rvest)
library(tidyverse)
library(stringr)
#爬取主页面#
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- read_html(web_base)
for(i in 1:2)
{
web_m <- paste0(web_base,i+1)
web[[i+1]] <- read_html(web_m)
i = i+1
}
#爬取每年的网站链接#
year_link <- vector("list", 3)
for(i in 1:3)
{
year_link[[i]] <- html_nodes(web[[i]], "div.alist a") %>% html_attr("href")
i = i+1
}
head(year_link)
web[[1]][14]
year_link[[1]][14]
k <- year_link[[1]][14] %>% read_html() %>% html_table()
k <- paste0("http://mac.gov.cn",year_link[[1]][14]) %>% read_html() %>% html_table()
paste0("http://mac.gov.cn",year_link[[1]][14])
l <- paste0("http://mac.gov.cn",year_link[[1]][14])
k <- l %>% read_html() %>% html_table()
l <- paste0("http://www.mca.gov.cn",year_link[[1]][14])
k <- l %>% read_html() %>% html_table()
k <- l %>% read_html() %>% html_nodes("table")
View(k)
devtools::install_github(repo = "Rwebdriver", username = "crubba")
library(Rwerdbriver)
devtools::install_github("crubba/Rwebdriver")
install.packages("devtools")
library(devtools)
devtools::install_github("crubba/Rwebdriver")
library(Rwerdbriver)
library(Rwerbdriver)
library(Rwebdriver)
m <- post.url(l)
m <- post.url(url = l)
l <- paste0("http://www.mca.gov.cn",year_link[[1]][14])
m <- post.url(url = l)
m <- post.url(url = l)
try_1 <- page_source()
start_session(browser = "chrome")
post.url(url = l)
pageneeded <- page_source()
start_session(browser = "chrome")
post.url(url = "http://www.mca.gov.cn/article/sj/xzqh/1980/201507/20150715854916.shtml")
pageneeded <- page_source()
library(Rwebdriver)
install.packages("RCurl")
install.packages("XML")
library(XML)
library(RCurl)
start_session(browser = "chrome")
post.url(url = "http://www.mca.gov.cn/article/sj/xzqh/1980/201507/20150715854916.shtml")
pageneeded <- page_source()
start_session(root = "http//localhost:4444/wd/hub", browser = "chrome")
post.url(url = "http://www.mca.gov.cn/article/sj/xzqh/1980/201507/20150715854916.shtml")
pageneeded <- page_source()
library(rvest)
library(tidyverse)
library(stringr)
library(devtools)
library(Rwebdriver)
library(XML)
library(RCurl)
install.packages("XML")
#爬取主页面#
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- read_html(web_base)
for(i in 1:2)
{
web_m <- paste0(web_base,i+1)
web[[i+1]] <- read_html(web_m)
i = i+1
}
#爬取每年的网站链接#
year_link <- vector("list", 3)
for(i in 1:3)
{
year_link_m[[i]] <- html_nodes(web[[i]], "div.alist a") %>% html_attr("href")
i = i+1
}
head(year_link_m)
for(i in 1:3)
{
year_link[[i]] <- paste0("http://www.mca.gov.cn", year_link_m[[i]])
i = i+1
}
install.packages("XML")
#爬取主页面#
web <- vector("list", 3)
web_base <- "http://www.mca.gov.cn/article/sj/xzqh/1980/?"
web[[1]] <- read_html(web_base)
for(i in 1:2)
{
web_m <- paste0(web_base,i+1)
web[[i+1]] <- read_html(web_m)
i = i+1
}
#爬取每年的网站链接#
year_link <- vector("list", 3)
for(i in 1:3)
{
year_link_m[[i]] <- html_nodes(web[[i]], "div.alist a") %>% html_attr("href")
i = i+1
}
head(year_link_m)
for(i in 1:3)
{
year_link[[i]] <- paste0("http://www.mca.gov.cn", year_link_m[[i]])
i = i+1
}
#爬取每年的网站链接#
year_link <- vector("list", 3)
year_link_m <- vector("list", 3)
for(i in 1:3)
{
year_link_m[[i]] <- html_nodes(web[[i]], "div.alist a") %>% html_attr("href")
i = i+1
}
head(year_link_m)
for(i in 1:3)
{
year_link[[i]] <- paste0("http://www.mca.gov.cn", year_link_m[[i]])
i = i+1
}
View(year_link_m)
head(year_link)
